<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üì§ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶°</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; color: white; padding: 20px;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        .glass {
            background: rgba(255,255,255,0.1); backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2); border-radius: 25px;
            padding: 40px; margin: 40px 0; text-align: center;
        }
        .upload-zone {
            border: 4px dashed rgba(255,255,255,0.5); border-radius: 20px;
            padding: 80px 40px; cursor: pointer; transition: all 0.3s;
            margin: 40px 0;
        }
        .upload-zone:hover, .upload-zone.dragover {
            border-color: #00ff88 !important; background: rgba(0,255,136,0.15);
            transform: scale(1.03);
        }
        .upload-icon { font-size: 80px; margin-bottom: 25px; }
        .upload-title { font-size: 32px; font-weight: 800; margin-bottom: 15px; }
        input[type="file"] { display: none; }
        #qrCode { margin: 20px auto; background: white; padding: 20px; border-radius: 15px; }
        .admin-login { display: none; }
        .admin-login.show { display: block !important; }
        #adminSecret { 
            width: 100%; padding: 20px; border: none; border-radius: 15px;
            background: rgba(255,255,255,0.2); color: white; font-size: 18px;
            margin-bottom: 20px; text-align: center;
        }
        .admin-btn {
            background: linear-gradient(135deg, #ffd700, #ffed4e); color: #000;
            border: none; padding: 18px 40px; border-radius: 25px;
            font-size: 18px; font-weight: 700; cursor: pointer; margin: 10px;
        }
        .admin-dashboard { display: none; }
        .header h1 {
            font-size: 36px; background: linear-gradient(135deg, #00ff88, #ffd700);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .logout-btn {
            background: rgba(255,100,100,0.3); color: #ff6464; border: none;
            padding: 15px 30px; border-radius: 25px; font-weight: 700; cursor: pointer;
        }
        .stats-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px; margin: 30px 0;
        }
        .stat-card {
            background: rgba(255,255,255,0.15); padding: 30px; border-radius: 20px;
            text-align: center;
        }
        .stat-number { font-size: 40px; font-weight: 800; color: #ffd700; }
        .files-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px; margin-top: 30px;
        }
        .file-card {
            background: rgba(255,255,255,0.15); border-radius: 20px; padding: 25px;
            transition: all 0.3s;
        }
        .file-card:hover { transform: translateY(-8px); }
        .file-preview {
            width: 100%; height: 200px; object-fit: cover; border-radius: 15px;
            margin-bottom: 15px; background: rgba(0,0,0,0.4);
        }
        .file-actions { display: flex; gap: 12px; }
        .action-btn {
            flex: 1; padding: 12px; border: none; border-radius: 12px;
            font-weight: 600; cursor: pointer;
        }
        .download-btn { background: linear-gradient(135deg, #00ff88, #00cc6a); color: white; }
        .delete-btn { background: rgba(255,100,100,0.4); color: #ff6464; }
        .toast {
            position: fixed; top: 30px; right: 30px; background: #00ff88;
            color: #000; padding: 20px 30px; border-radius: 15px;
            font-weight: 700; z-index: 9999; animation: slideIn 0.3s;
        }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } }
    </style>
</head>
<body>
    <div class="container">
        <!-- ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° -->
        <div class="glass user-upload" id="userUpload">
            <div class="upload-icon">‚¨ÜÔ∏è</div>
            <h1 class="upload-title">‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</h1>
            <p style="opacity: 0.9; margin-bottom: 20px;">‡¶õ‡¶¨‡¶ø, ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì, ‡¶°‡¶ï‡ßÅ‡¶Æ‡ßá‡¶®‡ßç‡¶ü (‡ß´‡ß¶MB ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§)</p>
            <div id="qrCode" style="max-width: 300px; margin: 0 auto 30px;"></div>
            <div class="upload-zone" id="uploadZone">
                <div style="font-size: 24px; margin-bottom: 10px;">‡¶ï‡ßç‡¶≤‡¶ø‡¶ï/‡¶°‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</div>
                <input type="file" id="fileInput" multiple>
            </div>
            <div id="uploadStatus" style="opacity: 0.8;"></div>
        </div>

        <!-- ‡¶π‡¶æ‡¶á‡¶°‡ßá‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶® -->
        <div class="glass admin-login" id="adminLogin">
            <h1 style="color: #ffd700; margin-bottom: 30px;">üîê ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø</h1>
            <input type="password" id="adminSecret" placeholder="‡¶∏‡¶ø‡¶ï‡ßç‡¶∞‡ßá‡¶ü ‡¶ï‡ßÄ">
            <button class="admin-btn" onclick="app.adminLogin()">‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø</button>
            <p style="margin-top: 20px; opacity: 0.7;">‡¶∏‡¶ø‡¶ï‡ßç‡¶∞‡ßá‡¶ü: <strong>mysecret2026</strong></p>
        </div>

        <!-- ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶° -->
        <div class="admin-dashboard glass" id="adminDashboard">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h1>üìä ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡ßá‡¶ü ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶∏</h1>
                <button class="logout-btn" onclick="app.logout()">‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
            </div>
            <div style="background: rgba(0,0,0,0.3); padding: 25px; border-radius: 15px; margin-bottom: 30px;">
                <div style="font-family: monospace; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                    ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞: <span id="shareLink"></span>
                </div>
                <div style="font-family: monospace; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                    ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶®: <span id="adminLink"></span>
                </div>
                <button class="admin-btn" onclick="app.copyLink()">üìã ‡¶ï‡¶™‡¶ø</button>
            </div>
            <div class="stats-grid" id="stats"></div>
            <div class="files-grid" id="filesGrid"></div>
        </div>
    </div>

    <script>
        class FixedSecretDB {
            constructor() {
                this.SECRET_KEY = 'mysecret2026';
                this.DB_NAME = 'fixedSecretDB_v2';
                window.app = this;
                this.files = [];
                this.isAdmin = false;
                this.init();
            }

            init() {
                // üîß ‡¶´‡¶ø‡¶ï‡ßç‡¶∏: ‡¶∏‡¶¨‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
                this.loadFiles();
                this.checkAdminAccess();
                this.bindEvents();
                setInterval(() => this.loadFiles(), 2000); // ‡ß® ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶ï
            }

            loadFiles() {
                try {
                    const saved = localStorage.getItem(this.DB_NAME);
                    if (saved) {
                        const newFiles = JSON.parse(saved);
                        if (JSON.stringify(newFiles) !== JSON.stringify(this.files)) {
                            this.files = newFiles;
                            if (this.isAdmin) {
                                this.renderFiles();
                                this.updateStats();
                            }
                        }
                    }
                } catch(e) {
                    console.log('DB load error:', e);
                }
            }

            saveFiles() {
                localStorage.setItem(this.DB_NAME, JSON.stringify(this.files));
                document.getElementById('uploadStatus').textContent = '‚úÖ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§!';
                setTimeout(() => {
                    document.getElementById('uploadStatus').textContent = '';
                }, 2000);
            }

            checkAdminAccess() {
                const urlParams = new URLSearchParams(window.location.search);
                if (urlParams.get('admin') === 'secret') {
                    document.getElementById('adminLogin').classList.add('show');
                    document.getElementById('userUpload').style.display = 'none';
                }
                document.getElementById('shareLink').textContent = window.location.origin + window.location.pathname;
                document.getElementById('adminLink').textContent = window.location.origin + window.location.pathname + '?admin=secret';
                this.generateQR();
            }

            generateQR() {
                const userUrl = window.location.origin + window.location.pathname;
                setTimeout(() => {
                    if (typeof QRCode !== 'undefined' && document.getElementById('qrCode')) {
                        new QRCode(document.getElementById('qrCode'), {
                            text: userUrl,
                            width: 250,
                            height: 250
                        });
                    }
                }, 500);
            }

            bindEvents() {
                const uploadZone = document.getElementById('uploadZone');
                const fileInput = document.getElementById('fileInput');

                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(event => {
                    uploadZone.addEventListener(event, e => {
                        e.preventDefault();
                        if (event === 'dragenter' || event === 'dragover') {
                            uploadZone.classList.add('dragover');
                        } else {
                            uploadZone.classList.remove('dragover');
                        }
                        if (event === 'drop') {
                            this.handleFiles(e.dataTransfer.files);
                        }
                    });
                });

                uploadZone.onclick = () => fileInput.click();
                fileInput.onchange = e => {
                    this.handleFiles(e.target.files);
                    e.target.value = '';
                };

                document.getElementById('adminSecret').addEventListener('keypress', e => {
                    if (e.key === 'Enter') this.adminLogin();
                });
            }

            adminLogin() {
                const secret = document.getElementById('adminSecret').value;
                if (secret === this.SECRET_KEY) {
                    this.isAdmin = true;
                    this.showAdmin();
                    this.toast('‚úÖ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶≤‡¶ó‡¶á‡¶® ‡¶∏‡¶´‡¶≤!');
                } else {
                    this.toast('‚ùå ‡¶≠‡ßÅ‡¶≤ ‡¶∏‡¶ø‡¶ï‡ßç‡¶∞‡ßá‡¶ü!');
                }
            }

            showAdmin() {
                document.getElementById('userUpload').style.display = 'none';
                document.getElementById('adminLogin').style.display = 'none';
                document.getElementById('adminDashboard').style.display = 'block';
                this.renderFiles();
                this.updateStats();
            }

            logout() {
                this.isAdmin = false;
                document.getElementById('adminDashboard').style.display = 'none';
                document.getElementById('adminLogin').style.display = 'block';
            }

            handleFiles(files) {
                Array.from(files).forEach(async (file) => {
                    if (file.size > 50 * 1024 * 1024) {
                        this.toast('‚ùå ‡ß´‡ß¶MB ‡¶è‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶®‡¶Ø‡¶º!');
                        return;
                    }

                    const reader = new FileReader();
                    reader.onload = () => {
                        const fileData = {
                            id: Date.now() + '_' + Math.random().toString(36),
                            name: file.name,
                            size: this.formatBytes(file.size),
                            sizeBytes: file.size,
                            type: file.type || 'unknown',
                            data: reader.result,
                            time: new Date().toLocaleString('bn-BD'),
                            device: navigator.userAgent.slice(0, 30)
                        };
                        
                        this.files.unshift(fileData);
                        this.saveFiles();
                        this.toast(`‚úÖ ${file.name} ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§!`);
                    };
                    reader.readAsDataURL(file);
                });
            }

            renderFiles() {
                const container = document.getElementById('filesGrid');
                if (!this.files.length) {
                    container.innerHTML = '<div style="grid-column:1/-1;text-align:center;padding:80px;opacity:0.6;"><div style="font-size:80px;margin-bottom:30px;">üìÇ</div><h3>‡¶ï‡ßã‡¶®‡ßã ‡¶´‡¶æ‡¶á‡¶≤ ‡¶®‡ßá‡¶á</h3></div>';
                    return;
                }
                
                container.innerHTML = this.files.map(f => `
                    <div class="file-card">
                        ${this.getPreview(f)}
                        <div style="font-weight:700;color:#ffd700;font-size:18px;margin-bottom:8px;">${this.escapeHtml(f.name)}</div>
                        <div style="color:rgba(255,255,255,0.8);font-size:14px;margin-bottom:15px;">${f.size} ‚Ä¢ ${f.time}</div>
                        <div class="file-actions">
                            <a href="${f.data}" download="${this.escapeHtml(f.name)}" class="action-btn download-btn">‚¨áÔ∏è ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</a>
                            <button class="action-btn delete-btn" onclick="app.deleteFile('${f.id}')">üóëÔ∏è ‡¶Æ‡ßÅ‡¶õ‡ßÅ‡¶®</button>
                        </div>
                    </div>
                `).join('');
            }

            getPreview(file) {
                if (file.type?.startsWith('image/')) {
                    return `<img src="${file.data}" class="file-preview" style="max-height:200px;">`;
                }
                if (file.type?.startsWith('video/')) {
                    return `<video src="${file.data}" class="file-preview" controls style="max-height:200px;"></video>`;
                }
                return `<div class="file-preview" style="display:flex;align-items:center;justify-content:center;font-size:48px;">${this.getIcon(file.type)}</div>`;
            }

            getIcon(type) {
                return type?.includes('pdf') ? 'üìÑ' : 'üìé';
            }

            deleteFile(id) {
                this.files = this.files.filter(f => f.id !== id);
                this.saveFiles();
                this.renderFiles();
                this.updateStats();
            }

            updateStats() {
                const total = this.files.length;
                const size = this.files.reduce((sum, f) => sum + f.sizeBytes, 0);
                document.getElementById('stats').innerHTML = `
                    <div class="stat-card"><div class="stat-number">${total}</div>‡¶Æ‡ßã‡¶ü ‡¶´‡¶æ‡¶á‡¶≤</div>
                    <div class="stat-card"><div class="stat-number">${(size/1024/1024).toFixed(1)}MB</div>‡¶Æ‡ßã‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú</div>
                `;
            }

            copyLink() {
                navigator.clipboard.writeText(document.getElementById('shareLink').textContent).then(() => {
                    this.toast('‚úÖ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶™‡¶ø!');
                });
            }

            formatBytes(bytes) {
                if (!bytes) return '0 B';
                const k = 1024, sizes = ['B','KB','MB','GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
            }

            escapeHtml(text) {
                const map = {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#039;'};
                return text.replace(/[&<>"']/g, m => map[m]);
            }

            toast(msg) {
                const toast = document.createElement('div');
                toast.className = 'toast'; toast.textContent = msg;
                document.body.appendChild(toast);
                setTimeout(() => toast.remove(), 3000);
            }
        }

        const app = new FixedSecretDB();
    </script>
</body>
</html>
